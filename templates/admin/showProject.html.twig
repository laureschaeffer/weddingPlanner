{% extends 'adminBase.html.twig' %}

{% block title %}Demande de contact{% endblock %}

{% block body %}


<section id="detail-projet">

    {{ dump(project) }}

    <h1>Détail d'une demande de contact</h1>
    
    {# en fonction de si la personne a été contactée  #}
    {% if project.isContacted %}
        <p class="projet-state"><i class="fa-solid fa-circle-check"></i></p>
        {% else %}
        <p class="projet-state"><i class="fa-solid fa-hourglass-start"></i></p>
    {% endif %}
    
    <div class="projet">
        <h2>{{project}}</h2>
        <div class="projet-entete">
            <div class="projet-entete-flex">
                <p>Reçu le {{project.dateReceipt | date("d.m.Y")}} </p>
                <p>Evenement le <b>{{project.dateEvent | date("d.m.Y")}}</b></p>
                <p> <small>{{project.nbGuest}} invités</small></p>
            </div>
            <div class="projet-entete-flex">
                <p> {{project.telephone }} </p>
                <p> {{project.email}} </p>
            </div>
        </div>

        {# prestations  #}
        <h4>Prestation(s) envisagée(s):</h4>
        {% for presta in project.prestations %}
            <p>{{presta}}</p>
        {% endfor %}

        {# budget  #}
        <h4>Budget: </h4>
        <p>{{project.budget.minPrice |number_format(0, ',', ' ')}} - {{project.budget.maxPrice |number_format(0, ',', ' ')}} €</p>

        {# description  #}
        <p> {{project.description}} </p>

    </div>

    <h3>Suivi du projet</h3>
    {# suivi du projet, commentaires des personnes présentes sur le pannel admin  #}
    {% for comment in project.comments %}

        <div class="projet-suivi">
            <p>Par <b>{{comment.user}}</b> le {{comment.datePost |format_datetime('short', 'short', locale='fr') }}</p>
            {# <p>Par {{comment.user}} le {{comment.datePost | date("d.m.Y")}}</p> #}
            <p>{{comment.content}} </p>
        </div>
    {% endfor %}
    
    {# ajout de commentaires  #}
    {{ form_start(form) }}

        {# {{ form_row(form.content) }} #}

        {{ form_errors(form.content) }}
        {{ form_label(form.content) }}
        <br>
        {{ form_widget(form.content) }}

        <br>
        {{ form_row(form.Envoyer, {'attr': {'class': 'add-btn'}}) }}


    {{ form_end(form) }}
    
    
    {% if app.user and "ROLE_SUPERADMIN" in app.user.roles %}
        
    {# en fonction de si le projet est terminé, bouton pour changer le statut de la demande  #}
        {% if project.isContacted %}
                <p><a href=" {{path('change_projet', {'id': project.id})}} ">Projet non fini</a></p>
        
            {% else %}
        
                <p><a href=" {{path('change_projet', {'id': project.id})}} ">Projet fini</a></p>
        {% endif %}
    {% endif %}

</section>

{% endblock %}
